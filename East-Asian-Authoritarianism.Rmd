---
title: "East-Asian-Authoritarianism"
author: "Jack Carter"
date: "4/10/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

options(dplyr.summarise.inform = FALSE)
library(dplyr, warn.conflicts = FALSE)
library(tidyverse)
library(tidyr)
library(tidytext)
library(ggrepel)
library(readxl)
library(ggplot2)
library(ggthemes)
library(naniar)
library(patchwork)
library(rvest)
library(pdftools)
library(patchwork)
library(here)
library(rtweet)
library(knitr)

### 1. functions ###
# 1.1 read in spreadsheet data without including the same tweets twice
read_data <- function(file_name, previous_file=NULL) {
  file <- read_twitter_csv(here("data", file_name)) %>%
    mutate(status_id = as.numeric(status_id))
  if(!is.null(previous_file)) file <- file %>%
      filter(status_id > max(previous_file$status_id))
  return(file)
}

# 1.2 break the text down and inner joins with the nrc sentiment library
join_words_with_sentiment <- function(raw_tweets) {
  nrc_sentiment <- get_sentiments("nrc") %>% 
    select(word, sentiment)
  words <- raw_tweets %>%
    unnest_tokens(word, text) %>%
    left_join(nrc_sentiment, by = "word") %>%
    mutate(sentiment = replace_na(sentiment, replace = "none")) %>%
    filter(!word %in% stop_words$word) %>%
    select(word, sentiment, country, region, 
           date_collected, tweets, search) %>%
    group_by(sentiment, country, region, date_collected, tweets, search) %>%
    count(sentiment) %>%
    rename(words = "n")
    return(words)
}

# 1.3 calculate the sentiments for each region as a %
calculate_final_value <- function(words) {
  final_value <- words %>%
    group_by(search, region, date_collected) %>%
    mutate(total_words = sum(words)) %>%
    group_by(search, region, sentiment, date_collected, total_words) %>%
    mutate(percent = words / total_words) %>%
    summarize(value = sum(percent) * 100)
}


### 2. read in the data ###
# 2.1 read in csv files
april_10_21 <- read_data("10-04-2021.csv")
april_17_21 <- read_data("17-04-2021.csv", april_10_21)
april_24_21 <- read_data("24-04-2021.csv", april_17_21)

# 2.2 bind the data sets together as a single object
combined_raw_data <- april_10_21 %>% 
  rbind(april_17_21) %>%
  rbind(april_24_21)


### 3. process the data
# 3.1 break the data down into individual words
words <- join_words_with_sentiment(combined_raw_data)

# 3.2 calculate the final values
tweets <- calculate_final_value(words) %>%
  spread(sentiment, value) %>%
  rename("Anticipation" = "anticipation",
         "Joy" = "joy",
         "Trust" = "trust",
         "Anger" = "anger",
         "Disgust" = "disgust",
         "Fear" = "fear") %>%
  gather(sentiment, value, -c(1:4)) 

# 3.3 processes the average values for anti-authority words
anti_authority_data <- tweets %>%
  filter(search %in% c("Protest", "Rebel", 
                       "Revolt", "Riot")) %>%
  group_by(region, date_collected, sentiment) %>%
  summarise(avg = sum(value) / length(value))


# democracy scores
democracy_scores <- tibble(country = c("China", "Vietnam", "Hong Kong",
                                       "Singapore", "US", "South Korea",
                                       "UK", "Taiwan", "Canada",
                                       "New Zealand", "South Africa", "Australia"),
                           region = c("Sinic", "Sinic", "Sinic",
                                      "Sinic", "Anglophone", "Sinic",
                                      "Anglophone", "Sinic", "Anglophone",
                                      "Anglophone", "Anglophone", "Anglophone"),
                           "Overall" = c(2.27, 2.94, 5.57,
                                       6.03, 7.72, 8.01,
                                       8.54, 8.94, 9.24,
                                       9.25, 7.05, 8.96),
                           "Electoral Process" = c(0, 0, 3.17,
                                                 4.83, 9.17, 9.17,
                                                 10, 10, 9.58,
                                                 10, 7.42, 10),
                           "Functioning Government" = c(4.29, 2.86, 3.64,
                                               7.86, 6.79, 8.21,
                                               7.5, 9.64, 8.93,
                                               8.93, 7.14, 8.57),
                           "Political Participation" = c(2.78, 3.89, 5,
                                             4.44, 8.89, 7.22,
                                             8.89, 7.22, 8.89,
                                             8.89, 8.33, 7.78),
                           "Political Culture" = c(3.13, 5.63, 7.50,
                                       6.25, 6.25, 7.5,
                                       7.50, 8.13, 9.38,
                                       8.75, 5, 8.75),
                           "Civil Liberties" = c(1.18, 2.35, 8.53,
                                               6.76, 8.53, 7.94,
                                               8.82, 9.71, 9.41,
                                               9.71, 7.35, 9.71)) %>%
  gather(type, value, -c(1:2))

# power distance scores
power_distance_scores <- tibble(country = c("China", "Hong Kong","Singapore", 
                                              "US", "South Korea","UK", 
                                              "Taiwan", "New Zealand", "South Africa", 
                                              "Australia"),
                                region = c("Sinic", "Sinic", "Sinic", 
                                           "Anglophone", "Sinic", "Anglophone", 
                                           "Sinic", "Anglophone", "Anglophone", 
                                           "Anglophone"),
                                power_distance = c(80, 68, 74, 
                                                     40, 60, 35,
                                                     58, 22, 49, 
                                                     36))

# re-election rate scores
reelection_rate_scores <- tibble(region = c("Anglophone", "Sinic"),
                                 Politicians = c(0.593406593, 1),
                                 Parties = c(0.598039216, 0.793103448)) %>%
  gather(type, value, -1) %>%
  mutate(value = value * 100)


### 4. plot theme
# 4.1 creates my personal plot theme
my_theme <- theme_economist_white(gray_bg = FALSE) +
  theme(plot.title = element_text(hjust = 0.5, 
                                  vjust = 12, 
                                  size = 10, 
                                  color = "#474747"),
        plot.margin = unit(c(1.5, 1, 1.5, 1), "cm"),
        axis.text = element_text(size = 9, 
                                 color = "gray30"),
        axis.text.x=element_text(vjust = -2.5),
        axis.title.x = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = -10),
        axis.title.y = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = 10),
        legend.direction = "vertical", 
        legend.position = "right",
        legend.title = element_blank(),
        legend.text = element_text(size = 12, 
                                   color = "gray20"),
        legend.margin=margin(1, -15, 1, 0),
        legend.spacing.x = unit(0.25, "cm"),
        legend.key.size = unit(1, "cm"), 
        legend.key.height = unit(0.75, "cm"),
        strip.text = element_text(hjust = 0.5, 
                                  vjust = 1, 
                                  size = 10, 
                                  color = "#474747"),
        panel.spacing = unit(2, "lines"))

```

## **Summary**

This report analyzes Authoritarianism between Sinic and Anglophone countries. It finds that Sinic country Twitter users demonstrate less positive sentiment when using freedom and a collection of anti-authority words. This may be due to the differing influence of Confucian verses European enlightenment values in defining attitudes to individual liberty. 

It could also however be the result of a difference in situational context. Many people in Hong Kong and Taiwan for instance likely tweet negatively about their own freedoms given China's growing regional assertiveness. South East Asian countries such as Singapore may also be more likely to tweet negatively about the tragic loss of freedom in Myanmar following a recent military coup. 

The rest of the report is organized into the following sections:

1. The Current Situation
2. Twitter: Sentiment Analysis

&nbsp;

## **1. The Current Situation**

### Democracy:

1.1: Overall democracy scores according to The Economist Intelligence Unit *(EIU, 2020)*.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

### 1. democracy ####
# 1.1 overall democracy
democracy_scores %>%
  filter(type == "Overall") %>%
  ggplot(aes(x = country, y = value, col = region)) +
  geom_point(alpha = 0.9) +
  geom_text_repel(aes(label=country), size = 2.25,
                  show.legend = FALSE,
                  max.overlaps = 5) +
  ggtitle("Democracy") +
  xlab("") +
  ylab("EIU score") +
  ylim(2, 10) +
  scale_color_manual(values = c("#0072B2", "#D55E00")) +
  theme_economist_white(gray_bg = FALSE) +
  my_theme +
  theme(axis.text.x=element_blank(),
        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), "cm"))

```

1.2: Aspects of democracy scores according to The Economist Intelligence Unit *(EIU, 2020)*.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# 1.2 aspects of democracy
democracy_scores %>%
  filter(!type == "Overall" & !type == "Functioning Government") %>%
  ggplot(aes(x = country, y = value, col = region)) +
  geom_point(alpha = 0.9) +
  geom_text_repel(aes(label=country), size = 2.25,
                  show.legend = FALSE,
                  max.overlaps = 5) +
  facet_wrap(~type) +
  ggtitle("Aspects of Democracy") +
  xlab("") +
  ylab("EIU score") +
  ylim(0, 13) +
  scale_color_manual(values = c("#0072B2", "#D55E00")) +
  theme_economist_white(gray_bg = FALSE) +
  my_theme +
  theme(axis.text.x=element_blank(),
        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), "cm"))

```

### Authority:

1.3: Power distance scores, the extent to which people accept unequal power in society *(Hofestede, 2010)*.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# 1.3 power distance
power_distance_scores %>%
  ggplot(aes(x = country, y = power_distance, col = region)) +
  geom_point(alpha = 0.9) +
  geom_text_repel(aes(label=country), size = 2.25,
                  show.legend = FALSE,
                  max.overlaps = 5) +
  ggtitle("Power Distance") +
  xlab("") +
  ylab("Score") +
  ylim(18, 82) +
  scale_color_manual(values = c("#0072B2", "#D55E00")) +
  theme_economist_white(gray_bg = FALSE) +
  my_theme +
  theme(axis.text.x=element_blank(),
        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), "cm"))

```

1.4: Re-election rates, the extent to which democratic societies (not including China and Vietnam) accept those in positions of power and authority.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# 1.4 re-election rates
reelection_rate_scores %>%
  ggplot(aes(x = region, y = value, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ type) +
  ggtitle("Re-election Rates") +
  ylab("%") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

&nbsp;

## **2. Twitter: Sentiment Analysis**

The analysis collects tweets from within a 50 mile range of the respective country capitals. A sentiment analysis is conducted using the NRC lexicon library. This is done by calculating how often words associated with certain sentiments occur relative to the respective regional totals. The data are then presented as bar charts with each set of bars representing a new week beginning on 10th April 2021. 

&nbsp;

### Summary statistics:

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

options(digits=3)

# 1.1 macro stats
total_words <- sum(words$words)

macro_words_table <- words %>%
  mutate(Region = region) %>%
  group_by(Region) %>%
  summarise(Words = sum(words) / 10^3,
            "Words (%)" = Words / (total_words) * 10^5) %>%
  rename("Words (000s)" = Words)

total_tweets <- sum(combined_raw_data$tweets)

macro_stats <- combined_raw_data %>%
  mutate(Region = region) %>%
  group_by(Region) %>%
  summarise(Tweets = sum(tweets) / 10^3,
            "Tweets (%)" = Tweets / (total_tweets) * 10^5) %>%
  rename("Tweets (000s)" = Tweets) %>%
  left_join(macro_words_table) %>%
  tibble()

kable(macro_stats, align = 'c')

```

&nbsp;

### Freedom:

2.1 The net sentiment for freedom. Net sentiment is calculated as positive minus negative words. 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

tweets %>%
  spread(sentiment, value) %>%
  mutate(net = positive - negative) %>%
  gather(sentiment, value, -c(1:5)) %>%
  filter(sentiment == "net",
         search == "Freedom") %>%
  ggplot(aes(x = date_collected, y = value, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  ggtitle("Net Sentiment") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.2 Positive emotions for freedom. 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

tweets %>%
  filter(search == "Freedom",
         sentiment %in% c("Anticipation", "Joy", "Trust")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Anticipation", "Joy", "Trust",
                                                  "Anger", "Disgust","Fear"))) %>%
  ggplot(aes(x = date_collected, y = value, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment) +
  ggtitle("Positive Emotions") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())


```

2.3 Negative emotions for freedom. 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

tweets %>%
  filter(search == "Freedom",
         sentiment %in% c("Anger", "Disgust","Fear")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Anticipation", "Joy", "Trust",
                                                  "Anger", "Disgust","Fear"))) %>%
  ggplot(aes(x = date_collected, y = value, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment) +
  ggtitle("Negative Emotions") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

&nbsp;

### Anti-Authority:

2.4 The net sentiment for anti-authority words (protest, rebel, revolt and riot). Net sentiment is calculated as positive minus negative words. 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

anti_authority_data %>%
  spread(sentiment, avg) %>%
  mutate(net = positive - negative) %>%
  gather(sentiment, avg, -c(1:2)) %>%
  filter(sentiment == "net") %>%
  ggplot(aes(x = date_collected, y = avg, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  ggtitle("Net Sentiment") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.5 Positive emotions for anti-authority words (protest, rebel, revolt and riot). 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

anti_authority_data %>%
  filter(sentiment %in% c("Anticipation", "Joy", "Trust")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Anticipation", "Joy", "Trust",
                                                  "Anger", "Disgust","Fear"))) %>%
  ggplot(aes(x = date_collected, y = avg, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment) +
  ggtitle("Positive Emotions") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.6 Negative emotions for anti-authority words (protest, rebel, revolt and riot). 

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

anti_authority_data %>%
  filter(sentiment %in% c("Anger", "Disgust","Fear")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Anticipation", "Joy", "Trust",
                                                  "Anger", "Disgust","Fear"))) %>%
  ggplot(aes(x = date_collected, y = avg, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment) +
  ggtitle("Negative Emotions") +
  ylab("Sentiment (%)") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

&nbsp;

## **Sources**


&nbsp;
&nbsp;
&nbsp;


