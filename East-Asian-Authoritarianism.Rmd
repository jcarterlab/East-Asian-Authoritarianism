---
title: "East Asian Authoritarianism?"
author: "Jack Carter"
date: "5/11/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

options(dplyr.summarise.inform = FALSE)
library(dplyr, warn.conflicts = FALSE)
library(tidyverse)
library(tidyr)
library(tidytext)
library(ggrepel)
library(readxl)
library(ggplot2)
library(ggthemes)
library(naniar)
library(patchwork)
library(rvest)
library(pdftools)
library(patchwork)
library(here)
library(rtweet)
library(knitr)
library(tibble)

# read in spreadsheet data without including duplicate 
# tweets  from the previous week's search results.  
read_data <- function(file_name, previous_file=NULL) {
  file <- read_twitter_csv(here("data", file_name)) %>%
    mutate(status_id = as.numeric(status_id))
  if(!is.null(previous_file)) file <- file %>%
      filter(status_id > max(previous_file$status_id))
  return(file)
}

# breaks the text down into single words, 
# inner joins them with the NRC library 
# and counts the frequency of each sentiment. 
join_words_with_sentiment <- function(raw_tweets) {
  nrc_sentiment <- get_sentiments("nrc") %>% select(word, sentiment)
  words <- raw_tweets %>%
    unnest_tokens(word, text) %>%
    left_join(nrc_sentiment, by = "word") %>%
    mutate(sentiment = replace_na(sentiment, replace = "none")) %>%
    filter(!word %in% stop_words$word) %>%
    group_by(search, region, country, sentiment, week) %>%
    count(sentiment) %>%
    rename(words = "n")
    return(words)
}

# calculates the sentiment for each region
# as a percentage of total words. 
calculate_regional_percentages <- function(words) {
  final_value <- words %>%
    group_by(region, week) %>%
    mutate(total_words = sum(words),
           percent = (words / total_words)*100) %>%
    select(region, sentiment, percent, week) %>%
    group_by(region, sentiment, week) %>%
    summarise(percent = sum(percent))
}

# calculates the sentiment for each country
# as a percentage of total words. 
calculate_country_percentages <- function(words) {
  final_value <- words %>%
    group_by(country, region, week) %>%
    mutate(total_words = sum(words),
           percent = (words / total_words)*100) %>%
    select(region, country, sentiment, percent, week) %>%
    group_by(region, country, sentiment, week) %>%
    summarise(percent = sum(percent))
}

# calculates the sentiment for each search term
# as a percentage of total words. 
calculate_search_term_percentages <- function(words) {
  final_value <- words %>%
    group_by(region, search, week) %>%
    mutate(total_words = sum(words),
           percent = (words / total_words)*100) %>%
    select(region, search, sentiment, percent, week) %>%
    group_by(region, search, sentiment, week) %>%
    summarise(percent = sum(percent))
}

# reads in the data from csv files. 
week_11_05_2021 <- read_data(file_name = "11-05-2021.csv",
                             previous_file = NULL)
week_18_05_2021 <- read_data(file_name = "18-05-2021.csv", 
                             previous_file = week_11_05_2021)
week_25_05_2021 <- read_data(file_name = "25-05-2021.csv",
                             previous_file = week_18_05_2021)
week_01_06_2021 <- read_data(file_name = "01-06-2021.csv",
                             previous_file = week_25_05_2021)
week_08_06_2021 <- read_data(file_name = "08-06-2021.csv",
                             previous_file = week_01_06_2021)
week_15_06_2021 <- read_data(file_name = "15-06-2021.csv",
                             previous_file = week_08_06_2021)
week_22_06_2021 <- read_data(file_name = "22-06-2021.csv",
                             previous_file = week_15_06_2021)
week_29_06_2021 <- read_data(file_name = "29-06-2021.csv",
                             previous_file = week_22_06_2021)
week_06_07_2021 <- read_data(file_name = "06-07-2021.csv",
                             previous_file = week_29_06_2021)


# binds the data together as a single object. 
combined_raw_data <- week_11_05_2021 %>%
  rbind(week_18_05_2021) %>%
  rbind(week_25_05_2021) %>%
  rbind(week_01_06_2021) %>%
  rbind(week_08_06_2021) %>%
  rbind(week_15_06_2021) %>%
  rbind(week_22_06_2021) %>%
  rbind(week_29_06_2021) %>%
  rbind(week_06_07_2021)

# counts the frequency of different NRC sentiments.  
words <- join_words_with_sentiment(combined_raw_data) %>%
  spread(sentiment, words) %>%
  rename("Anticipation" = "anticipation", "Joy" = "joy", "Trust" = "trust",
         "Anger" = "anger", "Disgust" = "disgust", "Fear" = "fear") %>%
  gather(sentiment, words, -c(1:4)) %>%
  mutate(words = replace_na(words, replace = 0)) 

# Calculates each sentiment as a percentage of 
# total words based on region. 
regional_percentages <- calculate_regional_percentages(words)

# calculates each sentiment as a percentage of 
# total words based on search term.  
search_term_percentages <-calculate_search_term_percentages(words) 

# calculates each sentiment as a percentage of 
# total words based on country.  
country_percentages <- calculate_country_percentages(words) 

# my personal plot theme for data visualizations. 
my_theme <- theme_economist_white(gray_bg = FALSE) +
  theme(plot.title = element_text(hjust = 0.5, 
                                  vjust = 12, 
                                  size = 9, 
                                  color = "#474747"),
        plot.margin = unit(c(1.5, 1, 1.5, 1), "cm"),
        axis.text = element_text(size = 9, 
                                 color = "gray30"),
        axis.text.x=element_text(vjust = -2.5),
        axis.title.x = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = -10),
        axis.title.y = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = 10),
        legend.direction = "vertical", 
        legend.position = "right",
        legend.title = element_blank(),
        legend.text = element_text(size = 12, 
                                   color = "gray20"),
        legend.margin=margin(1, -15, 1, 0),
        legend.spacing.x = unit(0.25, "cm"),
        legend.key.size = unit(1, "cm"), 
        legend.key.height = unit(0.75, "cm"),
        strip.text = element_text(hjust = 0.5, 
                                  vjust = 1, 
                                  size = 10, 
                                  color = "#474747"),
        panel.spacing = unit(2, "lines"))

# data tables: 
# power distance scores based Hofstede's cultural
# dimension's index. 
power_distance_scores <- tibble(country = c("China", "Hong Kong","Singapore", 
                                              "US", "South Korea","UK", 
                                              "Taiwan", "New Zealand", "South Africa", 
                                              "Australia"),
                                region = c("Sinic", "Sinic", "Sinic", 
                                           "Anglo", "Sinic", "Anglo", 
                                           "Sinic", "Anglo", "Anglo", 
                                           "Anglo"),
                                power_distance = c(80, 68, 74, 
                                                     40, 60, 35,
                                                     58, 22, 49, 
                                                     36))

# democracy scores based on The Economist Intelligence 
# Unit's (EIU) democracy index. 
democracy_scores <- tibble(country = c("China", "Vietnam", "Hong Kong",
                                       "Singapore", "US", "South Korea",
                                       "UK", "Taiwan", "Canada",
                                       "New Zealand", "South Africa", "Australia"),
                           region = c("Sinic", "Sinic", "Sinic",
                                      "Sinic", "Anglo", "Sinic",
                                      "Anglo", "Sinic", "Anglo",
                                      "Anglo", "Anglo", "Anglo"),
                           "Overall" = c(2.27, 2.94, 5.57,
                                       6.03, 7.72, 8.01,
                                       8.54, 8.94, 9.24,
                                       9.25, 7.05, 8.96),
                           "Electoral Process" = c(0, 0, 3.17,
                                                 4.83, 9.17, 9.17,
                                                 10, 10, 9.58,
                                                 10, 7.42, 10),
                           "Functioning Government" = c(4.29, 2.86, 3.64,
                                               7.86, 6.79, 8.21,
                                               7.5, 9.64, 8.93,
                                               8.93, 7.14, 8.57),
                           "Political Participation" = c(2.78, 3.89, 5,
                                             4.44, 8.89, 7.22,
                                             8.89, 7.22, 8.89,
                                             8.89, 8.33, 7.78),
                           "Political Culture" = c(3.13, 5.63, 7.50,
                                       6.25, 6.25, 7.5,
                                       7.50, 8.13, 9.38,
                                       8.75, 5, 8.75),
                           "Civil Liberties" = c(1.18, 2.35, 8.53,
                                               6.76, 8.53, 7.94,
                                               8.82, 9.71, 9.41,
                                               9.71, 7.35, 9.71)) %>%
  gather(type, value, -c(1:2))

```

## **Summary**

This repository analyzes anti-authority sentiment between Anglophone and Sinic countries. It finds that Sinic country Twitter users demonstrate significantly less positive sentiment in a collection of tweets containing nine anti-authority words. This may be due to the differing influence of Confucian verses European enlightenment values in defining attitudes towards individual liberty. 

Yet given how a large portion of Sinic users heavily criticize the recent military coup in Myanmar, these findings could also represent the growing use of hyperbolic language among increasingly split hierarchical and pro-democracy orientated groups in East Asia. The Sinic world may thus be both culturally hierarchical and experiencing a consolidation of democratic values among certain sections of society. 

The rest of the report is organized into the following sections: 

1) Authorianism 
2) Sentiment Analysis

&nbsp;

## **1: Authorianism**

1.1: Power distance scores in Hofstede's seminal cultural dimension's study. Power distance is the extent to which people accept unequal power and authority in society *(Hofstede, 1980)*.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# power distance
power_distance_scores %>%
  ggplot(aes(x = country, y = power_distance, col = region)) +
  geom_point(alpha = 0.9) +
  geom_text_repel(aes(label=country), size = 2.25,
                  show.legend = FALSE,
                  max.overlaps = 5) +
  ggtitle("Power Distance") +
  xlab("") +
  ylab("Power Distance Score") +
  ylim(18, 82) +
  scale_color_manual(values = c("#0072B2", "#D55E00")) +
  theme_economist_white(gray_bg = FALSE) +
  my_theme +
  theme(axis.text.x=element_blank(),
        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), "cm"))

```

1.2: Aspects of democracy according to The Economist Intelligence Unit's Democracy Index *(EIU, 2020)*.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# aspects of democracy
democracy_scores %>%
  filter(!type == "Overall" & !type == "Functioning Government") %>%
  ggplot(aes(x = country, y = value, col = region)) +
  geom_point(alpha = 0.9) +
  geom_text_repel(aes(label=country), size = 2.25,
                  show.legend = FALSE,
                  max.overlaps = 5) +
  facet_wrap(~type) +
  ggtitle("Democracy") +
  xlab("") +
  ylab("EIU score") +
  ylim(0, 13) +
  scale_color_manual(values = c("#0072B2", "#D55E00")) +
  theme_economist_white(gray_bg = FALSE) +
  my_theme +
  theme(axis.text.x=element_blank(),
        plot.margin = unit(c(1.5, 1.5, 1.5, 1.5), "cm"))

```

&nbsp;

## **2: Sentiment Analysis**

The tweets are collected within a 50 mile range of the Anglophone (the US, the UK, Canada, Australia, New Zealand and South Africa) and Sinic (China, Vietnam, Taiwan, South Korea, Hong Kong and Singapore) country capitals from the 11th of May 2021 to present. A sentiment analysis is then conducted using the NRC sentiment library.

The anti-authority words include 1) defy, 2) disobey, 3) dissent, 4) oppose, 5) protest, 6) rebel, 7) resist, 8) revolt and 9) riot.

Figures 2.1 to 2.2 show the scores for specific emotions across the combined anti-authority tweet collection, while figures 2.3 to 2.5 show net sentiment (positive minus negative scores). The results are presented as bar charts with each bar representing a different week.
 
<br>

### Summary Statistics:

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

options(digits=3)

# total tweets
total_tweets <- sum(nrow(combined_raw_data))

# regional tweets
regional_tweets <- combined_raw_data %>%
  mutate(Region = region) %>%
  group_by(Region) %>%
  summarise(Tweets = sum(tweets) / 10^3) %>%
  rename("Tweets (000s)" = Tweets)

# Combined table
combined_table <- regional_tweets %>%
  group_by(Region) %>%
  mutate("Tweets (%)" = (`Tweets (000s)` / total_tweets) * 10^5) %>%
  ungroup()

# final regional summary table
final_regional_table <- combined_table %>%
  add_row("Region" = "Total",
          "Tweets (000s)" = sum(combined_table$`Tweets (000s)`),
          "Tweets (%)" = 100)

kable(final_regional_table, align = 'c')

```

&nbsp;

### Specific Emotions:

2.1: The scores for selected positive emotions across the combined anti-authority tweet collection.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# positive emotions
regional_percentages %>%
  filter(sentiment %in% c("Joy", "Trust")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Joy", "Trust"))) %>%
  ggplot(aes(x = week, y = percent, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment, ncol = 2) +
  ggtitle("Positive Emotions") +
  ylab("% of Total Words") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.2: The scores for selected negative emotions across the combined anti-authority tweet collection.

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# negative emotions
regional_percentages %>%
  filter(sentiment %in% c("Anger", "Fear")) %>%
  mutate(sentiment = factor(sentiment, levels = c("Anger", "Fear"))) %>%
  ggplot(aes(x = week, y = percent, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~sentiment, ncol = 2) +
  ggtitle("Negative Emotions") +
  ylab("% of Total Words") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

### Net Sentiment:

2.3: The overall net sentiment. Net sentiment is calculated as positive minus negative words expressed as a percentage of the overall total.   

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# week
regional_percentages %>%
  spread(sentiment, percent) %>%
  mutate(net = positive - negative) %>%
  gather(sentiment, percent, -c(1:3)) %>%
  filter(sentiment == "net") %>%
  ggplot(aes(x = week, y = percent, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  ggtitle("Overall") +
  ylab("% of Total Words") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.4: The net sentiment for each country. Net sentiment is calculated as positive minus negative words expressed as a percentage of the country total.   

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# labels for the countries plot
country_labels <- c("AU", "CA", "NZ", "SA", "UK", "US",
                    "CH", "HG", "SG", "KR", "TW", "VT")

# selected countries 
country_percentages %>%
  spread(sentiment, percent) %>%
  mutate(net = positive - negative,
         country = factor(country, 
                          levels=c("Australia", "Canada", "New Zealand", 
                                   "South Africa", "UK", "US", 
                                   "China",  "Hong Kong", "Singapore", 
                                   "South Korea", "Taiwan", "Vietnam"))) %>%
  gather(sentiment, percent, -c(1:3)) %>%
  filter(sentiment == "net") %>%
  ggplot(aes(x = week, y = percent, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~country, scales = "free") +
  ggtitle("Country") +
  ylab("% of Total Words") +
  xlab("") +
  ylim(-6.5, 0) +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

2.5: The net sentiment for each search term. Net sentiment is calculated as positive minus negative words expressed as a percentage of search term total.  

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# search terms
search_term_percentages %>%
  spread(sentiment, percent) %>%
  mutate(net = positive - negative) %>%
  gather(sentiment, percent, -c(1:3)) %>%
  filter(sentiment == "net") %>%
  ggplot(aes(x = week, y = percent, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~search) +
  ggtitle("Search Term") +
  ylab("% of Total Words") +
  xlab("") +
  scale_fill_manual(values = c("#0072B2", "#D55E00")) +
  my_theme +
  theme(axis.text.x=element_blank())

```

&nbsp;

## **Sources**

- EIU (2020) https://www.eiu.com/n/campaigns/democracy-index-2020/

- Hofstede (1980) https://www.tandfonline.com/doi/abs/10.1080/00208825.1980.11656300?journalCode=mimo20

- Mohammad (2021) https://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm

- Twitter (2021) https://developer.twitter.com/en/apply-for-access

&nbsp;
&nbsp;
&nbsp;


